///
/// JHybridSeekbarStateUpdater.cpp
/// This file was generated by nitrogen. DO NOT MODIFY THIS FILE.
/// https://github.com/mrousavy/nitro
/// Copyright Â© 2025 Marc Rousavy @ Margelo
///

#include "JHybridSeekbarStateUpdater.hpp"
#include "views/HybridSeekbarComponent.hpp"
#include <NitroModules/NitroDefines.hpp>
#include <NitroModules/JNISharedPtr.hpp>

namespace margelo::nitro::seekbar::views {

using namespace facebook;
using ConcreteStateData = react::ConcreteState<HybridSeekbarState>;

void JHybridSeekbarStateUpdater::updateViewProps(jni::alias_ref<jni::JClass> /* class */,
                                           jni::alias_ref<JHybridSeekbarSpec::javaobject> javaView,
                                           jni::alias_ref<react::StateWrapperImpl::javaobject> stateWrapper) {
  JHybridSeekbarSpec* view = javaView->cthis();
  std::shared_ptr<const react::State> state = stateWrapper->cthis()->getState();
  auto concreteState = std::dynamic_pointer_cast<const ConcreteStateData>(state);
  const HybridSeekbarState& data = concreteState->getData();
  const std::optional<HybridSeekbarProps>& maybeProps = data.getProps();
  if (!maybeProps.has_value()) {
    // Props aren't set yet!
    throw std::runtime_error("HybridSeekbarState's data doesn't contain any props!");
  }
  const HybridSeekbarProps& props = maybeProps.value();
  if (props.position.isDirty) {
    view->setPosition(props.position.value);
    // TODO: Set isDirty = false
  }
  if (props.duration.isDirty) {
    view->setDuration(props.duration.value);
    // TODO: Set isDirty = false
  }
  if (props.readAheadValue.isDirty) {
    view->setReadAheadValue(props.readAheadValue.value);
    // TODO: Set isDirty = false
  }
  if (props.onValueChange.isDirty) {
    view->setOnValueChange(props.onValueChange.value);
    // TODO: Set isDirty = false
  }
  if (props.onValueChangeFinished.isDirty) {
    view->setOnValueChangeFinished(props.onValueChangeFinished.value);
    // TODO: Set isDirty = false
  }
  if (props.onSegmentChange.isDirty) {
    view->setOnSegmentChange(props.onSegmentChange.value);
    // TODO: Set isDirty = false
  }
  if (props.segments.isDirty) {
    view->setSegments(props.segments.value);
    // TODO: Set isDirty = false
  }
  if (props.seekerColors.isDirty) {
    view->setSeekerColors(props.seekerColors.value);
    // TODO: Set isDirty = false
  }
  if (props.seekerDimensions.isDirty) {
    view->setSeekerDimensions(props.seekerDimensions.value);
    // TODO: Set isDirty = false
  }

  // Update hybridRef if it changed
  if (props.hybridRef.isDirty) {
    // hybridRef changed - call it with new this
    const auto& maybeFunc = props.hybridRef.value;
    if (maybeFunc.has_value()) {
      auto shared = JNISharedPtr::make_shared_from_jni<JHybridSeekbarSpec>(jni::make_global(javaView));
      maybeFunc.value()(shared);
    }
    // TODO: Set isDirty = false
  }
}

} // namespace margelo::nitro::seekbar::views
